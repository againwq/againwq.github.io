<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>5G物理层过程 | Again&#39;s Blog</title>
<meta name="keywords" content="大唐杯">
<meta name="description" content="5G物理层过程概述 物理层,即PHY层
物理层主要功能 物理信道调制与解调 频率与时间同步 无线特征测量, 并向高层提供指示 MIMI天线处理 物理射频处理 5G的NR帧结构 见物理信道与信号那一篇
5G 帧结构配置 半静态配置: RRC配置, 小区专用与UE专用两种方式 动态配置: DCI(上行信道信息)配置, 使用SFI(时隙格式指示)和DCI调度两种方式 支持不同周期的配置 支持双周期配置 具体见物理信道与信号那一篇
物理层资源 基本时间为Tc = 1 / (f * N), 4G是其64倍
天线端口 小区搜索 PCI = PSS &#43; 3 * SSS 获得PCI可以得到DMRS(解调参考信号)以解调PBCH信道 MIB消息在PBCH上传输 SIB1消息在PDCCH和PDSCH上传输 PLMN PLMN分为手动和自动模式
频点选择 根据栅格计算频点
小区搜索 PSS 3条长度为127的伪随机序列,采用BPSK M序列 中间连续127个子载波, 两侧加8和9个保护间隔, 共144个子载波 PSS提供的计算PCI的N取值0,1,2 SSS 336条长度为127的伪随机序列,采用BPSK M序列 中间连续127个子载波, 两侧加8和9个保护间隔, 共144个子载波 SSS提供的计算PCI的N取值0 ~ 355 PCI PCI是物理小区ID, NR中,总共有1008个物理层小区ID UE获取PCI后, 解调DMRS for PBCH, 获取SSB的位置索引 PSS和SSS资源位置 PSS、SSS和PBCH构成SSB PSS、SSS、和PBCH公用天线端口号P=4000 SSB的子载波间隔不能取μ=2,即60KHz, μ=0,1为typeA, μ=3,4为typeB SSB最长符号数可取4,8,64(一个半帧内5ms, typeA) SSB周期: 5ms, 10ms, 20ms, 40ms, 80ms, 160ms 在初始小区搜索过程中,终端假定SSB周期为20ms SSB详细见物理信道与信号 小区选择和重选 小区选择 概述 UE在RRC_IDLE和RRC_INACTIVATE状态下进行 UE需要先完成PLMN的选择(小区搜索的部分), 在已选择的PLMN上选择合适的小区,获取合适的服务,监听控制信道,这个过程即小区选择过程 根据小区重选准则, UE寻找其他更合适的小区进行小区重选,重选后的小区若不属于UE已注册的TAC列表内,UE需要发起位置登记 小区禁止参数在MIB中给出(cellBarred) 小区预留参数在SIB1中给出(cellReservedForOperatorUse) 小区选择策略 UE先通过小区测量,测量波束强度再进行小区选择 多波束情况下,UE根据检测到的SSB最大波束测量值与门限对比,若大于门限值,则选择这个最强波束的小区,否则对检测到的所有最强波束进行线性平均,作为小区的最终测量值 相比于4G, 5G小区选择多了一个Qoffsettemp参数 小区重选 小区重选过程 小区重选是根据**频点优先级(SSB的频点优先级,0 ~ 7)**进行重选的 频点优先级获取方式: 系统消息和专用信令(如RRC Release消息) 重选流程: 重选参数获取 -&gt; 邻区启测判决 -&gt; 小区重选判决 重选参数获取 注: 只有SIB系统消息,没有MIB系统消息">
<meta name="author" content="xqc">
<link rel="canonical" href="https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E7%89%A9%E7%90%86%E5%B1%82%E8%BF%87%E7%A8%8B/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.54840a39f352dd1226fb566b940f4396c306c178f35053fd8eb1adf7a6af72eb.css" integrity="sha256-VIQKOfNS3RIm&#43;1ZrlA9DlsMGwXjzUFP9jrGt96avcus=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://againwq.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://againwq.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://againwq.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://againwq.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://againwq.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>


<link rel="icon" href="/avatar.png">

<script defer crossorigin="anonymous" src="/assets/js/extended/custom.js"></script><meta property="og:title" content="5G物理层过程" />
<meta property="og:description" content="5G物理层过程概述 物理层,即PHY层
物理层主要功能 物理信道调制与解调 频率与时间同步 无线特征测量, 并向高层提供指示 MIMI天线处理 物理射频处理 5G的NR帧结构 见物理信道与信号那一篇
5G 帧结构配置 半静态配置: RRC配置, 小区专用与UE专用两种方式 动态配置: DCI(上行信道信息)配置, 使用SFI(时隙格式指示)和DCI调度两种方式 支持不同周期的配置 支持双周期配置 具体见物理信道与信号那一篇
物理层资源 基本时间为Tc = 1 / (f * N), 4G是其64倍
天线端口 小区搜索 PCI = PSS &#43; 3 * SSS 获得PCI可以得到DMRS(解调参考信号)以解调PBCH信道 MIB消息在PBCH上传输 SIB1消息在PDCCH和PDSCH上传输 PLMN PLMN分为手动和自动模式
频点选择 根据栅格计算频点
小区搜索 PSS 3条长度为127的伪随机序列,采用BPSK M序列 中间连续127个子载波, 两侧加8和9个保护间隔, 共144个子载波 PSS提供的计算PCI的N取值0,1,2 SSS 336条长度为127的伪随机序列,采用BPSK M序列 中间连续127个子载波, 两侧加8和9个保护间隔, 共144个子载波 SSS提供的计算PCI的N取值0 ~ 355 PCI PCI是物理小区ID, NR中,总共有1008个物理层小区ID UE获取PCI后, 解调DMRS for PBCH, 获取SSB的位置索引 PSS和SSS资源位置 PSS、SSS和PBCH构成SSB PSS、SSS、和PBCH公用天线端口号P=4000 SSB的子载波间隔不能取μ=2,即60KHz, μ=0,1为typeA, μ=3,4为typeB SSB最长符号数可取4,8,64(一个半帧内5ms, typeA) SSB周期: 5ms, 10ms, 20ms, 40ms, 80ms, 160ms 在初始小区搜索过程中,终端假定SSB周期为20ms SSB详细见物理信道与信号 小区选择和重选 小区选择 概述 UE在RRC_IDLE和RRC_INACTIVATE状态下进行 UE需要先完成PLMN的选择(小区搜索的部分), 在已选择的PLMN上选择合适的小区,获取合适的服务,监听控制信道,这个过程即小区选择过程 根据小区重选准则, UE寻找其他更合适的小区进行小区重选,重选后的小区若不属于UE已注册的TAC列表内,UE需要发起位置登记 小区禁止参数在MIB中给出(cellBarred) 小区预留参数在SIB1中给出(cellReservedForOperatorUse) 小区选择策略 UE先通过小区测量,测量波束强度再进行小区选择 多波束情况下,UE根据检测到的SSB最大波束测量值与门限对比,若大于门限值,则选择这个最强波束的小区,否则对检测到的所有最强波束进行线性平均,作为小区的最终测量值 相比于4G, 5G小区选择多了一个Qoffsettemp参数 小区重选 小区重选过程 小区重选是根据**频点优先级(SSB的频点优先级,0 ~ 7)**进行重选的 频点优先级获取方式: 系统消息和专用信令(如RRC Release消息) 重选流程: 重选参数获取 -&gt; 邻区启测判决 -&gt; 小区重选判决 重选参数获取 注: 只有SIB系统消息,没有MIB系统消息" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E7%89%A9%E7%90%86%E5%B1%82%E8%BF%87%E7%A8%8B/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-04-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-04-17T00:00:00+00:00" />
<meta property="og:see_also" content="https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E7%9F%A5%E8%AF%86%E7%82%B9%E8%A1%A5%E5%85%85/" /><meta property="og:see_also" content="https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84%E4%B8%8E%E7%BB%84%E7%BD%91%E9%83%A8%E7%BD%B2/" /><meta property="og:see_also" content="https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E6%97%A0%E7%BA%BF%E6%8A%80%E6%9C%AF%E5%8F%8A%E5%BA%94%E7%94%A8/" /><meta property="og:see_also" content="https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E7%89%A9%E7%90%86%E4%BF%A1%E9%81%93%E4%B8%8E%E4%BF%A1%E5%8F%B7/" /><meta property="og:see_also" content="https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E4%BF%A1%E4%BB%A4%E4%B8%8E%E5%8D%8F%E8%AE%AE/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="5G物理层过程"/>
<meta name="twitter:description" content="5G物理层过程概述 物理层,即PHY层
物理层主要功能 物理信道调制与解调 频率与时间同步 无线特征测量, 并向高层提供指示 MIMI天线处理 物理射频处理 5G的NR帧结构 见物理信道与信号那一篇
5G 帧结构配置 半静态配置: RRC配置, 小区专用与UE专用两种方式 动态配置: DCI(上行信道信息)配置, 使用SFI(时隙格式指示)和DCI调度两种方式 支持不同周期的配置 支持双周期配置 具体见物理信道与信号那一篇
物理层资源 基本时间为Tc = 1 / (f * N), 4G是其64倍
天线端口 小区搜索 PCI = PSS &#43; 3 * SSS 获得PCI可以得到DMRS(解调参考信号)以解调PBCH信道 MIB消息在PBCH上传输 SIB1消息在PDCCH和PDSCH上传输 PLMN PLMN分为手动和自动模式
频点选择 根据栅格计算频点
小区搜索 PSS 3条长度为127的伪随机序列,采用BPSK M序列 中间连续127个子载波, 两侧加8和9个保护间隔, 共144个子载波 PSS提供的计算PCI的N取值0,1,2 SSS 336条长度为127的伪随机序列,采用BPSK M序列 中间连续127个子载波, 两侧加8和9个保护间隔, 共144个子载波 SSS提供的计算PCI的N取值0 ~ 355 PCI PCI是物理小区ID, NR中,总共有1008个物理层小区ID UE获取PCI后, 解调DMRS for PBCH, 获取SSB的位置索引 PSS和SSS资源位置 PSS、SSS和PBCH构成SSB PSS、SSS、和PBCH公用天线端口号P=4000 SSB的子载波间隔不能取μ=2,即60KHz, μ=0,1为typeA, μ=3,4为typeB SSB最长符号数可取4,8,64(一个半帧内5ms, typeA) SSB周期: 5ms, 10ms, 20ms, 40ms, 80ms, 160ms 在初始小区搜索过程中,终端假定SSB周期为20ms SSB详细见物理信道与信号 小区选择和重选 小区选择 概述 UE在RRC_IDLE和RRC_INACTIVATE状态下进行 UE需要先完成PLMN的选择(小区搜索的部分), 在已选择的PLMN上选择合适的小区,获取合适的服务,监听控制信道,这个过程即小区选择过程 根据小区重选准则, UE寻找其他更合适的小区进行小区重选,重选后的小区若不属于UE已注册的TAC列表内,UE需要发起位置登记 小区禁止参数在MIB中给出(cellBarred) 小区预留参数在SIB1中给出(cellReservedForOperatorUse) 小区选择策略 UE先通过小区测量,测量波束强度再进行小区选择 多波束情况下,UE根据检测到的SSB最大波束测量值与门限对比,若大于门限值,则选择这个最强波束的小区,否则对检测到的所有最强波束进行线性平均,作为小区的最终测量值 相比于4G, 5G小区选择多了一个Qoffsettemp参数 小区重选 小区重选过程 小区重选是根据**频点优先级(SSB的频点优先级,0 ~ 7)**进行重选的 频点优先级获取方式: 系统消息和专用信令(如RRC Release消息) 重选流程: 重选参数获取 -&gt; 邻区启测判决 -&gt; 小区重选判决 重选参数获取 注: 只有SIB系统消息,没有MIB系统消息"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "系列",
      "item": "https://againwq.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "5G物理层过程",
      "item": "https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E7%89%A9%E7%90%86%E5%B1%82%E8%BF%87%E7%A8%8B/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "5G物理层过程",
  "name": "5G物理层过程",
  "description": "5G物理层过程概述 物理层,即PHY层\n物理层主要功能 物理信道调制与解调 频率与时间同步 无线特征测量, 并向高层提供指示 MIMI天线处理 物理射频处理 5G的NR帧结构 见物理信道与信号那一篇\n5G 帧结构配置 半静态配置: RRC配置, 小区专用与UE专用两种方式 动态配置: DCI(上行信道信息)配置, 使用SFI(时隙格式指示)和DCI调度两种方式 支持不同周期的配置 支持双周期配置 具体见物理信道与信号那一篇\n物理层资源 基本时间为Tc = 1 / (f * N), 4G是其64倍\n天线端口 小区搜索 PCI = PSS + 3 * SSS 获得PCI可以得到DMRS(解调参考信号)以解调PBCH信道 MIB消息在PBCH上传输 SIB1消息在PDCCH和PDSCH上传输 PLMN PLMN分为手动和自动模式\n频点选择 根据栅格计算频点\n小区搜索 PSS 3条长度为127的伪随机序列,采用BPSK M序列 中间连续127个子载波, 两侧加8和9个保护间隔, 共144个子载波 PSS提供的计算PCI的N取值0,1,2 SSS 336条长度为127的伪随机序列,采用BPSK M序列 中间连续127个子载波, 两侧加8和9个保护间隔, 共144个子载波 SSS提供的计算PCI的N取值0 ~ 355 PCI PCI是物理小区ID, NR中,总共有1008个物理层小区ID UE获取PCI后, 解调DMRS for PBCH, 获取SSB的位置索引 PSS和SSS资源位置 PSS、SSS和PBCH构成SSB PSS、SSS、和PBCH公用天线端口号P=4000 SSB的子载波间隔不能取μ=2,即60KHz, μ=0,1为typeA, μ=3,4为typeB SSB最长符号数可取4,8,64(一个半帧内5ms, typeA) SSB周期: 5ms, 10ms, 20ms, 40ms, 80ms, 160ms 在初始小区搜索过程中,终端假定SSB周期为20ms SSB详细见物理信道与信号 小区选择和重选 小区选择 概述 UE在RRC_IDLE和RRC_INACTIVATE状态下进行 UE需要先完成PLMN的选择(小区搜索的部分), 在已选择的PLMN上选择合适的小区,获取合适的服务,监听控制信道,这个过程即小区选择过程 根据小区重选准则, UE寻找其他更合适的小区进行小区重选,重选后的小区若不属于UE已注册的TAC列表内,UE需要发起位置登记 小区禁止参数在MIB中给出(cellBarred) 小区预留参数在SIB1中给出(cellReservedForOperatorUse) 小区选择策略 UE先通过小区测量,测量波束强度再进行小区选择 多波束情况下,UE根据检测到的SSB最大波束测量值与门限对比,若大于门限值,则选择这个最强波束的小区,否则对检测到的所有最强波束进行线性平均,作为小区的最终测量值 相比于4G, 5G小区选择多了一个Qoffsettemp参数 小区重选 小区重选过程 小区重选是根据**频点优先级(SSB的频点优先级,0 ~ 7)**进行重选的 频点优先级获取方式: 系统消息和专用信令(如RRC Release消息) 重选流程: 重选参数获取 -\u0026gt; 邻区启测判决 -\u0026gt; 小区重选判决 重选参数获取 注: 只有SIB系统消息,没有MIB系统消息",
  "keywords": [
    "大唐杯"
  ],
  "articleBody": "5G物理层过程概述 物理层,即PHY层\n物理层主要功能 物理信道调制与解调 频率与时间同步 无线特征测量, 并向高层提供指示 MIMI天线处理 物理射频处理 5G的NR帧结构 见物理信道与信号那一篇\n5G 帧结构配置 半静态配置: RRC配置, 小区专用与UE专用两种方式 动态配置: DCI(上行信道信息)配置, 使用SFI(时隙格式指示)和DCI调度两种方式 支持不同周期的配置 支持双周期配置 具体见物理信道与信号那一篇\n物理层资源 基本时间为Tc = 1 / (f * N), 4G是其64倍\n天线端口 小区搜索 PCI = PSS + 3 * SSS 获得PCI可以得到DMRS(解调参考信号)以解调PBCH信道 MIB消息在PBCH上传输 SIB1消息在PDCCH和PDSCH上传输 PLMN PLMN分为手动和自动模式\n频点选择 根据栅格计算频点\n小区搜索 PSS 3条长度为127的伪随机序列,采用BPSK M序列 中间连续127个子载波, 两侧加8和9个保护间隔, 共144个子载波 PSS提供的计算PCI的N取值0,1,2 SSS 336条长度为127的伪随机序列,采用BPSK M序列 中间连续127个子载波, 两侧加8和9个保护间隔, 共144个子载波 SSS提供的计算PCI的N取值0 ~ 355 PCI PCI是物理小区ID, NR中,总共有1008个物理层小区ID UE获取PCI后, 解调DMRS for PBCH, 获取SSB的位置索引 PSS和SSS资源位置 PSS、SSS和PBCH构成SSB PSS、SSS、和PBCH公用天线端口号P=4000 SSB的子载波间隔不能取μ=2,即60KHz, μ=0,1为typeA, μ=3,4为typeB SSB最长符号数可取4,8,64(一个半帧内5ms, typeA) SSB周期: 5ms, 10ms, 20ms, 40ms, 80ms, 160ms 在初始小区搜索过程中,终端假定SSB周期为20ms SSB详细见物理信道与信号 小区选择和重选 小区选择 概述 UE在RRC_IDLE和RRC_INACTIVATE状态下进行 UE需要先完成PLMN的选择(小区搜索的部分), 在已选择的PLMN上选择合适的小区,获取合适的服务,监听控制信道,这个过程即小区选择过程 根据小区重选准则, UE寻找其他更合适的小区进行小区重选,重选后的小区若不属于UE已注册的TAC列表内,UE需要发起位置登记 小区禁止参数在MIB中给出(cellBarred) 小区预留参数在SIB1中给出(cellReservedForOperatorUse) 小区选择策略 UE先通过小区测量,测量波束强度再进行小区选择 多波束情况下,UE根据检测到的SSB最大波束测量值与门限对比,若大于门限值,则选择这个最强波束的小区,否则对检测到的所有最强波束进行线性平均,作为小区的最终测量值 相比于4G, 5G小区选择多了一个Qoffsettemp参数 小区重选 小区重选过程 小区重选是根据**频点优先级(SSB的频点优先级,0 ~ 7)**进行重选的 频点优先级获取方式: 系统消息和专用信令(如RRC Release消息) 重选流程: 重选参数获取 -\u003e 邻区启测判决 -\u003e 小区重选判决 重选参数获取 注: 只有SIB系统消息,没有MIB系统消息\n邻区启测判决 重选判决 都需要满足UE在服务小区驻留超过1s 随机接入(RA) 小区选择完成的是UE与基站下行同步, 随机接入要完成上行同步 包括竞争随机接入和非竞争随机接入 随机接入的场景 前导码(Preamble) 前导码分为长序列和短序列, 具体见物理信道与信号的PRACH(随机接入信道) 4G与5G RA的区别 5G中的RA, UE总是选择最好的beam, 即波束来执行RA过程 UE在SIB1消息读取到RACH信道的配置信息 基于竞争的随机接入 UE收到的msg2的资源不可用, 需要等待一个间隔重新发送msg1,这个间隔是BI msg2过程是在PDSCH进行的,在这之前需要在PDCCH信道中找到调度PDSCH的资源, 寻找的依据是RAPID, 具体来说是RAPID中的RA-RNTI 基于非竞争的RA 基于竞争的RA是随机选择Preamble码, 而非竞争的RA是由上层指定Preamble码 随机接入的具体过程 gNB向UE下发SIB1：这是启动随机接入过程的第一步，gNB通过下行控制信息(DCI)格式1_0，携带SI-RNTI(广播网络临时标识),通过PDCCH或PDSCH通道发送给UE，指示其进行随机接入 UE获取PRACH资源配置：UE通过监听PDCCH或PDSCH通道，获取gNB分配的随机接入资源，这包括PRACH的时频位置和长度等信息 UE传输PRACH Preamble(msg1)：UE在PRACH信道上发送带有PA-RNTI的PRACH Preamble，该Preamble是UE的随机接入尝试的一部分 gNB发送DCI格式1_0：gNB在检测到UE发送的PRACH Preamble后，通过DCI格式1_0，携带RA-RNTI，并在PDCCH或PDSCH上发送，以回应UE的随机接入尝试 gNB通过PDCCH或PDSCH发送MSG2：此信令中包含了TC-RNTI、跟踪区域（TA）和上行许可（UL-Grant），是gNB对UE随机接入尝试的响应 UE通过PUSCH信道发送MSG3：UE在接收到gNB的响应后，通过PUSCH信道发送包含UEID的消息，以完成随机接入过程的这一阶段 gNB发送DCI格式1_0：gNB再次通过DCI格式1_0，携带TC-RNTI，分配资源用于UE的链接响应 gNB通过PDCCH或PDSCH发送MSG4：此信令中包含了UEID，是gNB对UE链接响应的确认 UE通过PDCCH或PDSCH发送MSG5：UE在接收到gNB的确认后，通过PDCCH或PDSCH信道发送最后一个消息，以完成随机接入过程 功率控制 功控作用 抑制小区间干扰 省电, 减少发射功率 在小区内, 主要用于补偿路损和阴影 功控分为上行功率控制和下行功率分配\n上行功率控制 PRACH功率控制: UE在UL BWP(上行BWP)确定PRACH的功率 PUSCH功率控制(专门传输Msg3) PUSCH功率控制 PUCCH功率控制 SRS功率控制 波束管理 UE在RRC_ACTIVE和RRC_IDLE都需要进行波束管理\nRRC_ACTIVE: 下行使用CSI-RS和SSB, 上行用SRS RRC_IDLE: 下行用SSB, 上行用PRACH 波束管理包括波束上报, 波束指示,波束恢复 空闲态 下行 基站侧采用窄波束+轮询发送SSB和系统消息 UE侧采用窄波束+轮询接受的方式, 选择合适的波束 上行 就是进行随机接入(采用PRACH信道) 连接态 下行 基站侧进行分级扫描, 波束由宽到窄 UE采用先宽波束+轮询, 再根据接收到的TCI状态,固定接受波角度(不轮询了)使用窄波束 第三阶段, 基站采用波束方向固定+窄波束, UE采用窄波束+轮询 上行 UE完成接入后, 上行通过SRS进行波束训练(不支持波束细化训练) 基站通过参数直接指定上行所使用的波束SRS Resource ID 波束恢复 UE先进行波束失败检测, 然后UE发送BFRQ(波束失败恢复请求), 基站进行新的候选波束的选择,并响应BFRP(波束恢复响应)\n波束恢复请求方式 通过非竞争的PRACH 通过PUCCH FFS: 基于竞争的PRACH HARQ过程(混合自动重传请求) HARQ是FEC和ARQ的一种混合技术机制 HARQ是MAC层的快速传输机制 NR中,上下行均采用异步HARQ 不支持跨小区HARQ重传 HARQ实体和HARQ进程 每个小区有一个HARQ实体,上下行HARQ实体相互独立 HARQ进程数量是UE级配置参数,上行固定16个,下行可配置,最多16个 仅支持顺序HARQ调度 DCI format1_0和1_1会携带部分HARQ信息 DCI中的NDI可以用来判断接受的**TB块(传输块)**是新传块还是重传块 CBG TB: 传输块 CB: 码块 CBG: 码块组 一个TB(包含CRC)超过CB最大长度限定后,TB会被切分成多个CB发送,把一个TB切分成的CB进行分组(而不是整个一起传),每个组叫做CBG\n一个TB最大的CBG个数: 2,4,6,8(需要RRC高层配置) ",
  "wordCount" : "239",
  "inLanguage": "zh",
  "datePublished": "2024-04-17T00:00:00Z",
  "dateModified": "2024-04-17T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "xqc"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E7%89%A9%E7%90%86%E5%B1%82%E8%BF%87%E7%A8%8B/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Again's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://againwq.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://againwq.github.io" accesskey="h" title="Again&#39;s Blog (Alt + H)">
                <img src="https://againwq.github.io/images/avatar.png" alt="" aria-label="logo"
                    height="35">Again&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://againwq.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://againwq.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://againwq.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://againwq.github.io/posts/" title="Series">
                    <span>Series</span>
                </a>
            </li>
            <li>
                <a href="https://againwq.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://againwq.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://againwq.github.io">主页</a>&nbsp;»&nbsp;<a href="https://againwq.github.io/posts/">系列</a></div>
    <h1 class="post-title">
      5G物理层过程
    </h1>
    <div class="post-meta"><span title='2024-04-17 00:00:00 +0000 UTC'>2024-04-17</span>&nbsp;·&nbsp;xqc

</div>
  </header>
  <div class="tags-container">
    <ul class="post-tags">
      <li><a href="https://againwq.github.io/tags/%E5%A4%A7%E5%94%90%E6%9D%AF/">大唐杯</a></li>
    </ul>
  </div> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#5g%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b%e6%a6%82%e8%bf%b0" aria-label="5G物理层过程概述">5G物理层过程概述</a><ul>
                        
                <li>
                    <a href="#%e7%89%a9%e7%90%86%e5%b1%82%e4%b8%bb%e8%a6%81%e5%8a%9f%e8%83%bd" aria-label="物理层主要功能">物理层主要功能</a></li>
                <li>
                    <a href="#5g%e7%9a%84nr%e5%b8%a7%e7%bb%93%e6%9e%84" aria-label="5G的NR帧结构">5G的NR帧结构</a></li>
                <li>
                    <a href="#5g-%e5%b8%a7%e7%bb%93%e6%9e%84%e9%85%8d%e7%bd%ae" aria-label="5G 帧结构配置">5G 帧结构配置</a><ul>
                        
                <li>
                    <a href="#%e7%89%a9%e7%90%86%e5%b1%82%e8%b5%84%e6%ba%90" aria-label="物理层资源">物理层资源</a><ul>
                        
                <li>
                    <a href="#%e5%a4%a9%e7%ba%bf%e7%ab%af%e5%8f%a3" aria-label="天线端口">天线端口</a></li></ul>
                </li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e5%b0%8f%e5%8c%ba%e6%90%9c%e7%b4%a2" aria-label="小区搜索">小区搜索</a><ul>
                        
                <li>
                    <a href="#plmn" aria-label="PLMN">PLMN</a></li>
                <li>
                    <a href="#%e9%a2%91%e7%82%b9%e9%80%89%e6%8b%a9" aria-label="频点选择">频点选择</a></li>
                <li>
                    <a href="#%e5%b0%8f%e5%8c%ba%e6%90%9c%e7%b4%a2-1" aria-label="小区搜索">小区搜索</a><ul>
                        
                <li>
                    <a href="#pss" aria-label="PSS">PSS</a></li>
                <li>
                    <a href="#sss" aria-label="SSS">SSS</a></li>
                <li>
                    <a href="#pci" aria-label="PCI">PCI</a></li>
                <li>
                    <a href="#pss%e5%92%8csss%e8%b5%84%e6%ba%90%e4%bd%8d%e7%bd%ae" aria-label="PSS和SSS资源位置">PSS和SSS资源位置</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e5%b0%8f%e5%8c%ba%e9%80%89%e6%8b%a9%e5%92%8c%e9%87%8d%e9%80%89" aria-label="小区选择和重选">小区选择和重选</a><ul>
                        
                <li>
                    <a href="#%e5%b0%8f%e5%8c%ba%e9%80%89%e6%8b%a9" aria-label="小区选择">小区选择</a><ul>
                        
                <li>
                    <a href="#%e6%a6%82%e8%bf%b0" aria-label="概述">概述</a></li>
                <li>
                    <a href="#%e5%b0%8f%e5%8c%ba%e9%80%89%e6%8b%a9%e7%ad%96%e7%95%a5" aria-label="小区选择策略">小区选择策略</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%b0%8f%e5%8c%ba%e9%87%8d%e9%80%89" aria-label="小区重选">小区重选</a><ul>
                        
                <li>
                    <a href="#%e5%b0%8f%e5%8c%ba%e9%87%8d%e9%80%89%e8%bf%87%e7%a8%8b" aria-label="小区重选过程">小区重选过程</a></li>
                <li>
                    <a href="#%e9%87%8d%e9%80%89%e5%8f%82%e6%95%b0%e8%8e%b7%e5%8f%96" aria-label="重选参数获取">重选参数获取</a></li>
                <li>
                    <a href="#%e9%82%bb%e5%8c%ba%e5%90%af%e6%b5%8b%e5%88%a4%e5%86%b3" aria-label="邻区启测判决">邻区启测判决</a></li>
                <li>
                    <a href="#%e9%87%8d%e9%80%89%e5%88%a4%e5%86%b3" aria-label="重选判决">重选判决</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e9%9a%8f%e6%9c%ba%e6%8e%a5%e5%85%a5ra" aria-label="随机接入(RA)">随机接入(RA)</a><ul>
                        
                <li>
                    <a href="#%e9%9a%8f%e6%9c%ba%e6%8e%a5%e5%85%a5%e7%9a%84%e5%9c%ba%e6%99%af" aria-label="随机接入的场景">随机接入的场景</a></li>
                <li>
                    <a href="#%e5%89%8d%e5%af%bc%e7%a0%81preamble" aria-label="前导码(Preamble)">前导码(Preamble)</a></li>
                <li>
                    <a href="#4g%e4%b8%8e5g-ra%e7%9a%84%e5%8c%ba%e5%88%ab" aria-label="4G与5G RA的区别">4G与5G RA的区别</a></li>
                <li>
                    <a href="#%e5%9f%ba%e4%ba%8e%e7%ab%9e%e4%ba%89%e7%9a%84%e9%9a%8f%e6%9c%ba%e6%8e%a5%e5%85%a5" aria-label="基于竞争的随机接入">基于竞争的随机接入</a></li>
                <li>
                    <a href="#%e5%9f%ba%e4%ba%8e%e9%9d%9e%e7%ab%9e%e4%ba%89%e7%9a%84ra" aria-label="基于非竞争的RA">基于非竞争的RA</a></li>
                <li>
                    <a href="#%e9%9a%8f%e6%9c%ba%e6%8e%a5%e5%85%a5%e7%9a%84%e5%85%b7%e4%bd%93%e8%bf%87%e7%a8%8b" aria-label="随机接入的具体过程">随机接入的具体过程</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%8a%9f%e7%8e%87%e6%8e%a7%e5%88%b6" aria-label="功率控制">功率控制</a><ul>
                        
                <li>
                    <a href="#%e5%8a%9f%e6%8e%a7%e4%bd%9c%e7%94%a8" aria-label="功控作用">功控作用</a></li>
                <li>
                    <a href="#%e4%b8%8a%e8%a1%8c%e5%8a%9f%e7%8e%87%e6%8e%a7%e5%88%b6" aria-label="上行功率控制">上行功率控制</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%b3%a2%e6%9d%9f%e7%ae%a1%e7%90%86" aria-label="波束管理">波束管理</a><ul>
                        
                <li>
                    <a href="#%e7%a9%ba%e9%97%b2%e6%80%81" aria-label="空闲态">空闲态</a><ul>
                        
                <li>
                    <a href="#%e4%b8%8b%e8%a1%8c" aria-label="下行">下行</a></li>
                <li>
                    <a href="#%e4%b8%8a%e8%a1%8c" aria-label="上行">上行</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%bf%9e%e6%8e%a5%e6%80%81" aria-label="连接态">连接态</a><ul>
                        
                <li>
                    <a href="#%e4%b8%8b%e8%a1%8c-1" aria-label="下行">下行</a></li>
                <li>
                    <a href="#%e4%b8%8a%e8%a1%8c-1" aria-label="上行">上行</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%b3%a2%e6%9d%9f%e6%81%a2%e5%a4%8d" aria-label="波束恢复">波束恢复</a></li>
                <li>
                    <a href="#%e6%b3%a2%e6%9d%9f%e6%81%a2%e5%a4%8d%e8%af%b7%e6%b1%82%e6%96%b9%e5%bc%8f" aria-label="波束恢复请求方式">波束恢复请求方式</a></li></ul>
                </li>
                <li>
                    <a href="#harq%e8%bf%87%e7%a8%8b%e6%b7%b7%e5%90%88%e8%87%aa%e5%8a%a8%e9%87%8d%e4%bc%a0%e8%af%b7%e6%b1%82" aria-label="HARQ过程(混合自动重传请求)">HARQ过程(混合自动重传请求)</a><ul>
                        
                <li>
                    <a href="#harq%e5%ae%9e%e4%bd%93%e5%92%8charq%e8%bf%9b%e7%a8%8b" aria-label="HARQ实体和HARQ进程">HARQ实体和HARQ进程</a></li>
                <li>
                    <a href="#cbg" aria-label="CBG">CBG</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="5g物理层过程概述">5G物理层过程概述<a hidden class="anchor" aria-hidden="true" href="#5g物理层过程概述">#</a></h2>
<p>物理层,即<strong>PHY层</strong></p>
<h3 id="物理层主要功能">物理层主要功能<a hidden class="anchor" aria-hidden="true" href="#物理层主要功能">#</a></h3>
<ol>
<li>物理信道调制与解调</li>
<li>频率与时间同步</li>
<li>无线特征测量, 并向高层提供指示</li>
<li>MIMI天线处理</li>
<li>物理射频处理</li>
</ol>
<h3 id="5g的nr帧结构">5G的NR帧结构<a hidden class="anchor" aria-hidden="true" href="#5g的nr帧结构">#</a></h3>
<p>见<strong>物理信道与信号</strong>那一篇</p>
<h3 id="5g-帧结构配置">5G 帧结构配置<a hidden class="anchor" aria-hidden="true" href="#5g-帧结构配置">#</a></h3>
<ul>
<li><strong>半静态配置</strong>: <strong>RRC配置</strong>, 小区专用与UE专用两种方式</li>
<li><strong>动态配置</strong>: <strong>DCI(上行信道信息)配置</strong>, 使用<strong>SFI(时隙格式指示)<strong>和</strong>DCI调度两种方式</strong></li>
<li>支持不同周期的配置</li>
<li>支持双周期配置</li>
</ul>
<p>具体见<strong>物理信道与信号</strong>那一篇</p>
<h4 id="物理层资源">物理层资源<a hidden class="anchor" aria-hidden="true" href="#物理层资源">#</a></h4>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%b5%84%e6%ba%90.PNG" alt="5G物理层资源"  />
</p>
<p>基本时间为<strong>T<sub>c</sub> = 1 / (f * N)</strong>, 4G是其<strong>64倍</strong></p>
<h5 id="天线端口">天线端口<a hidden class="anchor" aria-hidden="true" href="#天线端口">#</a></h5>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/%e5%a4%a9%e7%ba%bf%e7%ab%af%e5%8f%a3.PNG" alt="天线端口"  />
</p>
<h2 id="小区搜索">小区搜索<a hidden class="anchor" aria-hidden="true" href="#小区搜索">#</a></h2>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/%e5%b0%8f%e5%8c%ba%e6%90%9c%e7%b4%a2%e6%b5%81%e7%a8%8b.PNG" alt="小区搜索流程"  />
</p>
<ul>
<li><strong>PCI = PSS + 3 * SSS</strong></li>
<li>获得PCI可以得到<strong>DMRS(解调参考信号)<strong>以解调</strong>PBCH信道</strong></li>
<li><strong>MIB消息</strong>在<strong>PBCH</strong>上传输</li>
<li><strong>SIB1</strong>消息在<strong>PDCCH和PDSCH</strong>上传输</li>
</ul>
<h3 id="plmn">PLMN<a hidden class="anchor" aria-hidden="true" href="#plmn">#</a></h3>
<p><strong>PLMN</strong>分为<strong>手动和自动模式</strong></p>
<h3 id="频点选择">频点选择<a hidden class="anchor" aria-hidden="true" href="#频点选择">#</a></h3>
<p>根据<strong>栅格计算频点</strong></p>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/%e9%a2%91%e7%82%b9%e9%80%89%e6%8b%a9.PNG" alt="频点选择"  />
</p>
<h3 id="小区搜索-1">小区搜索<a hidden class="anchor" aria-hidden="true" href="#小区搜索-1">#</a></h3>
<h4 id="pss">PSS<a hidden class="anchor" aria-hidden="true" href="#pss">#</a></h4>
<ul>
<li><strong>3条</strong>长度为<strong>127</strong>的伪随机序列,采用<strong>BPSK M</strong>序列</li>
<li>中间连续127个子载波, 两侧加8和9个保护间隔, 共<strong>144个子载波</strong></li>
<li>PSS提供的计算PCI的N取值<strong>0,1,2</strong></li>
</ul>
<h4 id="sss">SSS<a hidden class="anchor" aria-hidden="true" href="#sss">#</a></h4>
<ul>
<li><strong>336条</strong>长度为<strong>127</strong>的伪随机序列,采用<strong>BPSK M</strong>序列</li>
<li>中间连续127个子载波, 两侧加8和9个保护间隔, 共<strong>144个子载波</strong></li>
<li>SSS提供的计算PCI的N取值<strong>0 ~ 355</strong></li>
</ul>
<h4 id="pci">PCI<a hidden class="anchor" aria-hidden="true" href="#pci">#</a></h4>
<ul>
<li>PCI是物理小区ID, NR中,总共有<strong>1008</strong>个物理层小区ID</li>
<li>UE获取PCI后, 解调<strong>DMRS for PBCH</strong>, 获取SSB的位置索引</li>
</ul>
<h4 id="pss和sss资源位置">PSS和SSS资源位置<a hidden class="anchor" aria-hidden="true" href="#pss和sss资源位置">#</a></h4>
<ul>
<li>PSS、SSS和PBCH构成<strong>SSB</strong></li>
<li>PSS、SSS、和PBCH<strong>公用天线端口号P=4000</strong></li>
<li>SSB的子载波间隔<strong>不能取μ=2,即60KHz</strong>, μ=0,1为<strong>typeA</strong>, μ=3,4为<strong>typeB</strong></li>
<li>SSB最长符号数可取<strong>4,8,64</strong>(<strong>一个半帧内5ms, typeA</strong>)</li>
<li>SSB周期: <strong>5ms, 10ms, 20ms, 40ms, 80ms, 160ms</strong></li>
<li>在初始小区搜索过程中,终端假定SSB周期为<strong>20ms</strong></li>
<li>SSB详细见<strong>物理信道与信号</strong></li>
</ul>
<h2 id="小区选择和重选">小区选择和重选<a hidden class="anchor" aria-hidden="true" href="#小区选择和重选">#</a></h2>
<h3 id="小区选择">小区选择<a hidden class="anchor" aria-hidden="true" href="#小区选择">#</a></h3>
<h4 id="概述">概述<a hidden class="anchor" aria-hidden="true" href="#概述">#</a></h4>
<ul>
<li>UE在<strong>RRC_IDLE和RRC_INACTIVATE</strong>状态下进行</li>
<li>UE需要先完成<strong>PLMN</strong>的选择(小区搜索的部分), 在已选择的PLMN上选择合适的小区,获取合适的服务,监听控制信道,这个过程即小区选择过程</li>
<li>根据小区重选准则, UE寻找其他更合适的小区进行小区重选,重选后的小区若不属于UE<strong>已注册的TAC</strong>列表内,UE需要发起位置登记</li>
<li><strong>小区禁止参数</strong>在<strong>MIB</strong>中给出(cellBarred)</li>
<li><strong>小区预留参数</strong>在<strong>SIB1</strong>中给出(cellReservedForOperatorUse)</li>
</ul>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/%e5%b0%8f%e5%8c%ba%e9%a2%84%e7%95%99.PNG" alt="小区预留"  />
</p>
<h4 id="小区选择策略">小区选择策略<a hidden class="anchor" aria-hidden="true" href="#小区选择策略">#</a></h4>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/%e5%b0%8f%e5%8c%ba%e9%80%89%e6%8b%a9%e7%ad%96%e7%95%a5.png" alt="小区选择策略"  />
</p>
<ul>
<li>UE先通过<strong>小区测量,测量波束强度</strong>再进行小区选择</li>
<li>多波束情况下,UE根据检测到的<strong>SSB最大波束</strong>测量值与门限对比,若大于门限值,则选择这个<strong>最强波束的小区</strong>,否则对检测到的所有最强波束进行<strong>线性平均</strong>,作为小区的最终测量值</li>
<li>相比于4G, 5G小区选择多了一个<strong>Qoffset<sub>temp</sub>参数</strong></li>
</ul>
<h3 id="小区重选">小区重选<a hidden class="anchor" aria-hidden="true" href="#小区重选">#</a></h3>
<h4 id="小区重选过程">小区重选过程<a hidden class="anchor" aria-hidden="true" href="#小区重选过程">#</a></h4>
<ul>
<li>小区重选是根据**频点优先级(SSB的频点优先级,0 ~ 7)**进行重选的</li>
<li>频点优先级获取方式: <strong>系统消息和专用信令(如RRC Release消息)</strong></li>
<li><strong>重选流程</strong>: <strong>重选参数获取 -&gt; 邻区启测判决 -&gt; 小区重选判决</strong></li>
</ul>
<h4 id="重选参数获取">重选参数获取<a hidden class="anchor" aria-hidden="true" href="#重选参数获取">#</a></h4>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/%e5%b0%8f%e5%8c%ba%e9%87%8d%e9%80%89%e5%8f%82%e6%95%b0%e8%8e%b7%e5%8f%96.PNG" alt="小区重选参数获取"  />
</p>
<p>注: 只有<strong>SIB</strong>系统消息,没有<strong>MIB</strong>系统消息</p>
<h4 id="邻区启测判决">邻区启测判决<a hidden class="anchor" aria-hidden="true" href="#邻区启测判决">#</a></h4>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/%e9%82%bb%e5%8c%ba%e5%90%af%e6%b5%8b%e5%88%a4%e5%86%b3.PNG" alt="邻区启测判决"  />
</p>
<h4 id="重选判决">重选判决<a hidden class="anchor" aria-hidden="true" href="#重选判决">#</a></h4>
<ul>
<li>都需要满足UE在<strong>服务小区</strong>驻留超过<strong>1s</strong></li>
</ul>
<h2 id="随机接入ra">随机接入(RA)<a hidden class="anchor" aria-hidden="true" href="#随机接入ra">#</a></h2>
<ul>
<li>小区选择完成的是UE与基站<strong>下行同步</strong>, 随机接入要完成<strong>上行同步</strong></li>
<li>包括<strong>竞争随机接入</strong>和<strong>非竞争随机接入</strong></li>
</ul>
<h3 id="随机接入的场景">随机接入的场景<a hidden class="anchor" aria-hidden="true" href="#随机接入的场景">#</a></h3>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/%e9%9a%8f%e6%9c%ba%e6%8e%a5%e5%85%a5%e5%9c%ba%e6%99%af.PNG" alt="随机接入场景"  />
</p>
<h3 id="前导码preamble">前导码(Preamble)<a hidden class="anchor" aria-hidden="true" href="#前导码preamble">#</a></h3>
<ul>
<li>前导码分为<strong>长序列和短序列</strong>, 具体见物理信道与信号的<strong>PRACH(随机接入信道)</strong></li>
</ul>
<h3 id="4g与5g-ra的区别">4G与5G RA的区别<a hidden class="anchor" aria-hidden="true" href="#4g与5g-ra的区别">#</a></h3>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/4G5G%e5%9c%a8RA%e7%9a%84%e5%8c%ba%e5%88%ab.PNG" alt="4G5G在RA的区别"  />
</p>
<ul>
<li>5G中的RA, UE总是选择最好的<strong>beam, 即波束</strong>来执行RA过程</li>
<li>UE在<strong>SIB1消息</strong>读取到<strong>RACH信道的配置信息</strong></li>
</ul>
<h3 id="基于竞争的随机接入">基于竞争的随机接入<a hidden class="anchor" aria-hidden="true" href="#基于竞争的随机接入">#</a></h3>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/%e5%9f%ba%e4%ba%8e%e7%ab%9e%e4%ba%89%e7%9a%84%e9%9a%8f%e6%9c%ba%e6%8e%a5%e5%85%a5%e8%bf%87%e7%a8%8b.PNG" alt="基于竞争的随机接入"  />
</p>
<ul>
<li>UE收到的msg2的<strong>资源不可用</strong>, 需要等待一个间隔重新发送msg1,这个间隔是<strong>BI</strong></li>
<li>msg2过程是在<strong>PDSCH</strong>进行的,在这之前需要在<strong>PDCCH信道中</strong>找到调度PDSCH的资源, 寻找的依据是<strong>RAPID</strong>, 具体来说是RAPID中的<strong>RA-RNTI</strong></li>
</ul>
<h3 id="基于非竞争的ra">基于非竞争的RA<a hidden class="anchor" aria-hidden="true" href="#基于非竞争的ra">#</a></h3>
<p><img loading="lazy" src="http://120.55.68.94/picture/5G%e7%89%a9%e7%90%86%e5%b1%82%e8%bf%87%e7%a8%8b/%e5%9f%ba%e4%ba%8e%e9%9d%9e%e7%ab%9e%e4%ba%89%e7%9a%84RA.PNG" alt="基于非竞争的RA"  />
</p>
<ul>
<li>基于竞争的RA是<strong>随机选择</strong>Preamble码, 而非竞争的RA是由<strong>上层指定</strong>Preamble码</li>
</ul>
<h3 id="随机接入的具体过程">随机接入的具体过程<a hidden class="anchor" aria-hidden="true" href="#随机接入的具体过程">#</a></h3>
<ul>
<li>gNB向UE下发<strong>SIB1</strong>：这是启动随机接入过程的第一步，gNB通过<strong>下行控制信息(DCI)格式1_0</strong>，携带<strong>SI-RNTI</strong>(广播网络临时标识),通过<strong>PDCCH或PDSCH</strong>通道发送给UE，指示其进行随机接入</li>
<li>UE获取PRACH资源配置：UE通过监听PDCCH或PDSCH通道，获取gNB分配的随机接入资源，这包括PRACH的时频位置和长度等信息</li>
<li>UE传输PRACH Preamble(msg1)：UE在PRACH信道上发送<strong>带有PA-RNTI的PRACH Preamble</strong>，该Preamble是UE的随机接入尝试的一部分</li>
<li>gNB发送<strong>DCI格式1_0</strong>：gNB在检测到UE发送的PRACH Preamble后，通过DCI格式1_0，携带<strong>RA-RNTI</strong>，并在<strong>PDCCH或PDSCH</strong>上发送，以回应UE的随机接入尝试</li>
<li>gNB通过PDCCH或PDSCH发送<strong>MSG2</strong>：此信令中包含了TC-RNTI、跟踪区域（TA）和上行许可（UL-Grant），是gNB对UE随机接入尝试的响应</li>
<li>UE通过PUSCH信道发送<strong>MSG3</strong>：UE在接收到gNB的响应后，通过PUSCH信道发送包含UEID的消息，以完成随机接入过程的这一阶段</li>
<li>gNB发送DCI格式1_0：gNB<strong>再次通过DCI格式1_0</strong>，携带<strong>TC-RNTI</strong>，分配资源用于UE的链接响应</li>
<li>gNB通过PDCCH或PDSCH发送<strong>MSG4</strong>：此信令中包含了UEID，是<strong>gNB对UE链接响应的确认</strong></li>
<li>UE通过PDCCH或PDSCH发送MSG5：UE在接收到gNB的确认后，通过PDCCH或PDSCH信道发送最后一个消息，以完成随机接入过程</li>
</ul>
<h2 id="功率控制">功率控制<a hidden class="anchor" aria-hidden="true" href="#功率控制">#</a></h2>
<h3 id="功控作用">功控作用<a hidden class="anchor" aria-hidden="true" href="#功控作用">#</a></h3>
<ol>
<li>抑制小区间干扰</li>
<li>省电, 减少发射功率</li>
<li>在小区内, 主要用于补偿路损和阴影</li>
</ol>
<p>功控分为<strong>上行功率控制</strong>和<strong>下行功率分配</strong></p>
<h3 id="上行功率控制">上行功率控制<a hidden class="anchor" aria-hidden="true" href="#上行功率控制">#</a></h3>
<ul>
<li>PRACH功率控制: UE在<strong>UL BWP(上行BWP</strong>)确定PRACH的功率</li>
<li>PUSCH功率控制(专门传输Msg3)</li>
<li>PUSCH功率控制</li>
<li>PUCCH功率控制</li>
<li>SRS功率控制</li>
</ul>
<h2 id="波束管理">波束管理<a hidden class="anchor" aria-hidden="true" href="#波束管理">#</a></h2>
<p>UE在<strong>RRC_ACTIVE和RRC_IDLE</strong>都需要进行波束管理</p>
<ul>
<li>RRC_ACTIVE: 下行使用<strong>CSI-RS和SSB</strong>, 上行用<strong>SRS</strong></li>
<li>RRC_IDLE: 下行用<strong>SSB</strong>, 上行用<strong>PRACH</strong></li>
<li>波束管理包括<strong>波束上报, 波束指示,波束恢复</strong></li>
</ul>
<h3 id="空闲态">空闲态<a hidden class="anchor" aria-hidden="true" href="#空闲态">#</a></h3>
<h4 id="下行">下行<a hidden class="anchor" aria-hidden="true" href="#下行">#</a></h4>
<ul>
<li>基站侧采用<strong>窄波束+轮询</strong>发送<strong>SSB和系统消息</strong></li>
<li>UE侧采用<strong>窄波束+轮询</strong>接受的方式, 选择合适的波束</li>
</ul>
<h4 id="上行">上行<a hidden class="anchor" aria-hidden="true" href="#上行">#</a></h4>
<ul>
<li>就是进行<strong>随机接入</strong>(采用PRACH信道)</li>
</ul>
<h3 id="连接态">连接态<a hidden class="anchor" aria-hidden="true" href="#连接态">#</a></h3>
<h4 id="下行-1">下行<a hidden class="anchor" aria-hidden="true" href="#下行-1">#</a></h4>
<ul>
<li>基站侧进行<strong>分级扫描</strong>, <strong>波束由宽到窄</strong></li>
<li>UE采用<strong>先宽波束+轮询</strong>, 再根据接收到的TCI状态,<strong>固定接受波角度(不轮询了)使用窄波束</strong></li>
<li>第三阶段, 基站采用<strong>波束方向固定+窄波束</strong>, UE采用<strong>窄波束+轮询</strong></li>
</ul>
<h4 id="上行-1">上行<a hidden class="anchor" aria-hidden="true" href="#上行-1">#</a></h4>
<ul>
<li>UE完成接入后, 上行通过<strong>SRS</strong>进行波束训练(不支持波束细化训练)</li>
<li>基站通过参数直接指定上行所使用的波束<strong>SRS Resource ID</strong></li>
</ul>
<h3 id="波束恢复">波束恢复<a hidden class="anchor" aria-hidden="true" href="#波束恢复">#</a></h3>
<p>UE先进行<strong>波束失败检测</strong>, 然后UE发送<strong>BFRQ</strong>(波束失败恢复请求), 基站进行<strong>新的候选波束的选择</strong>,并响应<strong>BFRP</strong>(波束恢复响应)</p>
<h3 id="波束恢复请求方式">波束恢复请求方式<a hidden class="anchor" aria-hidden="true" href="#波束恢复请求方式">#</a></h3>
<ul>
<li>通过<strong>非竞争</strong>的PRACH</li>
<li>通过PUCCH</li>
<li>FFS: <strong>基于竞争</strong>的PRACH</li>
</ul>
<h2 id="harq过程混合自动重传请求">HARQ过程(混合自动重传请求)<a hidden class="anchor" aria-hidden="true" href="#harq过程混合自动重传请求">#</a></h2>
<ul>
<li>HARQ是<strong>FEC和ARQ</strong>的一种混合技术机制</li>
<li>HARQ是<strong>MAC</strong>层的快速传输机制</li>
<li>NR中,上下行均采用<strong>异步HARQ</strong></li>
<li>不支持<strong>跨小区</strong>HARQ重传</li>
</ul>
<h3 id="harq实体和harq进程">HARQ实体和HARQ进程<a hidden class="anchor" aria-hidden="true" href="#harq实体和harq进程">#</a></h3>
<ul>
<li>每个小区有<strong>一个</strong>HARQ实体,上下行HARQ实体相互<strong>独立</strong></li>
<li>HARQ进程数量是<strong>UE级配置参数</strong>,上行<strong>固定16个</strong>,下行可配置,最多<strong>16个</strong></li>
<li>仅支持<strong>顺序HARQ调度</strong></li>
<li><strong>DCI format1_0和1_1</strong>会携带部分HARQ信息</li>
<li>DCI中的<strong>NDI</strong>可以用来判断接受的**TB块(传输块)**是新传块还是重传块</li>
</ul>
<h3 id="cbg">CBG<a hidden class="anchor" aria-hidden="true" href="#cbg">#</a></h3>
<ul>
<li>TB: 传输块</li>
<li>CB: 码块</li>
<li>CBG: 码块组</li>
</ul>
<p><strong>一个TB(包含CRC)超过CB最大长度限定后,TB会被切分成多个CB发送,把一个TB切分成的CB进行分组(而不是整个一起传),每个组叫做CBG</strong></p>
<ul>
<li>一个TB最大的CBG个数: <strong>2,4,6,8</strong>(需要RRC高层配置)</li>
</ul>


  </div>

  <footer class="post-footer">
<nav class="paginav">
  <a class="prev" href="https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E7%9F%A5%E8%AF%86%E7%82%B9%E8%A1%A5%E5%85%85/">
    <span class="title">« 上一页</span>
    <br>
    <span>5G知识点补充</span>
  </a>
  <a class="next" href="https://againwq.github.io/posts/%E5%A4%A7%E5%94%90%E6%9D%AF/5g%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84%E4%B8%8E%E7%BB%84%E7%BD%91%E9%83%A8%E7%BD%B2/">
    <span class="title">下一页 »</span>
    <br>
    <span>5G网络架构及组网部署</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://againwq.github.io">Again&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
